{"version":3,"sources":["webpack:///./src/views/login/index.vue?b598","webpack:///./src/views/login/index.vue?c7ea","webpack:///./src/views/login/index.vue?5bd9","webpack:///./src/views/login/index.vue?e0c5","webpack:///./src/views/login/index.vue","webpack:///./src/api/user.js","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?159e"],"names":["login","data","request","method","url","getSmsCode","mobile","getUserInfo","user","getUserChannels","addFollow","target","deleteFollow","getUserProfile","updateUserName","updateUserAvatar"],"mappings":"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","file":"js/chunk-42ecb99f.1a3badbe.js","sourcesContent":["// extracted by mini-css-extract-plugin","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1932e8f1&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1932e8f1&lang=less&scoped=true&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"117cb3d0-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=1932e8f1&scoped=true&\"","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1932e8f1&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1932e8f1&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1932e8f1\",\n  null\n  \n)\n\nexport default component.exports","// 用户相关请求模块\nimport request from '@/utils/request'\n// import store from '@/store'\n\n// 登陆\nconst login = data => {\n  return request({\n    method: 'POST',\n    url: '/app/v1_0/authorizations',\n    data\n  })\n}\n// 获取验证码\nconst getSmsCode = mobile => {\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/sms/codes/${mobile}`\n  })\n}\n\n// 获取用户自己的信息\nconst getUserInfo = user => {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user'\n    // 发送请求头数据\n    // headers: {\n    //   // 注意：该接口需要授权才能访问\n    //   //       token的数据格式：Bearer token数据，注意 Bearer 后面有个空格\n    //   Authorization: `Bearer ${store.state.user.token}`\n    // }\n  })\n}\n\nconst getUserChannels = user => {\n  return request({\n    // method: 'GET',\n    url: '/app/v1_0/user/channels'\n    // 发送请求头数据\n    // headers: {\n    //   // 注意：该接口需要授权才能访问\n    //   //       token的数据格式：Bearer token数据，注意 Bearer 后面有个空格\n    //   Authorization: `Bearer ${store.state.user.token}`\n    // }\n  })\n}\n\n// 关注用户\n// 获取验证码\nconst addFollow = target => {\n  return request({\n    method: 'POST',\n    url: '/app/v1_0/user/followings',\n    data: {\n      target\n    }\n  })\n}\n\n// 取消关注\nconst deleteFollow = target => {\n  return request({\n    method: 'DELETE',\n    url: `/app/v1_0/user/followings/${target}`\n  })\n}\n\n/**\n * 获取用户个人资料\n */\n// 获取指定用户信息\nconst getUserProfile = () => {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user/profile'\n  })\n}\n/**\n * 更新昵称\n */\nconst updateUserName = data => {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/profile',\n    data\n  })\n}\n\n/**\n * 更新头像\n */\nconst updateUserAvatar = data => {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/photo',\n    data\n  })\n}\n\nexport {\n  login,\n  getSmsCode,\n  getUserInfo,\n  getUserChannels,\n  addFollow,\n  deleteFollow,\n  getUserProfile,\n  updateUserName,\n  updateUserAvatar\n}\n","<template>\n  <div>\n    <van-nav-bar class=\"page-nav-bar\" title=\"登陆\" left-arrow >\n        <van-icon slot=\"left\" name=\"cross\" @click=\"$router.back()\" />\n    </van-nav-bar>\n    <van-form @submit=\"onSubmit\" ref=\"loginForm\">\n      <van-field\n        v-model=\"user.mobile\"\n        name=\"mobile\"\n        placeholder=\"手机号\"\n        :rules=\"userRules.mobile\"\n        type=\"number\"\n        maxlength=\"11\"\n      >\n        <i slot=\"left-icon\" class=\"iconfont iconshouji\"></i>\n      </van-field>\n      <van-field\n        v-model=\"user.code\"\n        name=\"验证码\"\n        placeholder=\"验证码\"\n        :rules=\"userRules.code\"\n        type=\"number\"\n        maxlength=\"6\"\n      >\n      <i slot=\"left-icon\" class=\"iconfont iconyanzhengma\"></i>\n        <template #button>\n          <van-count-down :time=\"1000*60\" format=\"ss s\" @finish=\"isCountDownShow=false\" v-if=\"isCountDownShow\"/>\n          <van-button v-else class=\"send-sms-btn\" round size=\"small\" type=\"default\" native-type=\"button\" @click=\"onSend\">发送验证码</van-button>\n        </template>\n      </van-field>\n      <div style=\"margin: 16px;\" class=\"login-btn-warp\">\n        <van-button block type=\"info\" native-type=\"submit\" class=\"login-btn\">登陆</van-button>\n      </div>\n    </van-form>\n  </div>\n</template>\n\n<script>\nimport { login, getSmsCode } from '@/api/user.js'\nexport default {\n  name: 'login',\n  props: [],\n  data () {\n    return {\n      user: {\n        mobile: '',\n        code: ''\n      },\n      userRules: {\n        mobile: [{ required: true, message: '请填写手机号码' }, { pattern: /^1[3|7|9]\\d{9}$/, message: '手机号码格式错误' }],\n        code: [{ required: true, message: '请填写验证码' }, { pattern: /^\\d{6}/, message: '验证码格式错误' }]\n      },\n      isCountDownShow: false\n\n    }\n  },\n  created () {},\n  methods: {\n    async onSubmit () {\n      // 1.获取表单数据\n      const user = this.user\n      // .TODO: 2.验证表单\n      this.$toast.loading({\n        message: '加载中...',\n        forbidClick: true // 背景点击\n      })\n      // 3.提交表单验证请求\n      try {\n        // 请求成功返回数据token值\n        const res = await login(user)\n        // 将token值存储到本地\n        this.$store.commit('setUser', res.data.data)\n        this.$toast.success('登陆成功')\n        console.log('登陆成功', res)\n        this.$router.push('/')\n      } catch (error) {\n        if (error.response.status === 400) {\n          this.$toast.fail('验证码错误')\n          console.log('账号或验证码错误', error.config)\n        }\n      }\n    },\n    // 倒计时\n    async onSend () {\n      console.log('onSendSms')\n      // 1. 校验手机号\n      try {\n        await this.$refs.loginForm.validate('mobile')\n      } catch (err) {\n        return console.log('验证失败', err)\n      }\n      // 2. 验证通过，显示倒计时\n      this.isCountDownShow = true\n      // 3. 请求发送验证码\n      try {\n        await getSmsCode(this.user.mobile)\n        this.$toast('发送成功')\n      } catch (error) {\n        // 发送失败，关闭倒计时\n        this.isCountDownShow = false\n        if (error.response.status === 429) {\n          this.$toast('发送太频繁了，请稍后重试')\n        } else {\n          this.$toast('发送失败，请稍后重试')\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.iconfont{\n  font-size: 37px;\n}\n.send-sms-btn{\n  width: 160px;\n  height: 46px;\n  line-height: 46px;\n  background-color: #ededed;\n  font-size: 16px;\n  color: #666;\n}\n.login-btn-warp{\n  padding: 53px 33px;\n  .login-btn{\n    background-color: #6db4fb;\n    border: none;\n  }\n}\n</style>\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"title\":\"登陆\",\"left-arrow\":\"\"}},[_c('van-icon',{attrs:{\"slot\":\"left\",\"name\":\"cross\"},on:{\"click\":function($event){return _vm.$router.back()}},slot:\"left\"})],1),_c('van-form',{ref:\"loginForm\",on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"placeholder\":\"手机号\",\"rules\":_vm.userRules.mobile,\"type\":\"number\",\"maxlength\":\"11\"},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}},[_c('i',{staticClass:\"iconfont iconshouji\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('van-field',{attrs:{\"name\":\"验证码\",\"placeholder\":\"验证码\",\"rules\":_vm.userRules.code,\"type\":\"number\",\"maxlength\":\"6\"},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [(_vm.isCountDownShow)?_c('van-count-down',{attrs:{\"time\":1000*60,\"format\":\"ss s\"},on:{\"finish\":function($event){_vm.isCountDownShow=false}}}):_c('van-button',{staticClass:\"send-sms-btn\",attrs:{\"round\":\"\",\"size\":\"small\",\"type\":\"default\",\"native-type\":\"button\"},on:{\"click\":_vm.onSend}},[_vm._v(\"发送验证码\")])]},proxy:true}]),model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[_c('i',{staticClass:\"iconfont iconyanzhengma\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('div',{staticClass:\"login-btn-warp\",staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{staticClass:\"login-btn\",attrs:{\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登陆\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}